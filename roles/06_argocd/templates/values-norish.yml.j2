## Ingress settings
norish:
  image:
    repository: norishapp/norish
    tag: "v0.14.1-beta"
    pullPolicy: IfNotPresent

  ingress:
    enabled: true
    className: "traefik"
    annotations:
      traefik.ingress.kubernetes.io/router.entrypoints: websecure
    hosts:
      - host: norish.{{ domain }}
        paths:
          - path: /
            pathType: Prefix
    tls:
      - hosts:
          - norish.{{ domain }}

  ## Persistence settings
  persistence:
    enabled: true
    storageClass: "longhorn"
    accessMode: ReadWriteOnce
    size: 5Gi

  config:
    authUrl: "https://norish.{{ domain }}"
    trustedOrigins: "http://192.168.1.100:3000,https://norish.{{ domain }}"
    chromeWsEndpoint: "ws://127.0.0.1:9222"
    masterKey:
      value: "cp6eVbe4ddmJxlJCJyux5Nlk39gbJR3M9mWjAqEon1c="
{% if deploy_authentik %}
    auth:
      # OIDC/OAuth2 provider
      oidc:
        enabled: true
        name: "Authentik"
        issuer: "https://authentik.{{ domain }}/application/o/norish/"
        existingSecret: "norish-authentik-credentials"
        clientIdKey: "authentik_client_id"
        clientSecretKey: "authentik_client_secret"
{% endif %}

  database:
    # Database connection details
    host: "postgres-cluster-pooler.dbs.svc.cluster.local"                 # Required: PostgreSQL server hostname
    port: 5432
    # Use existing secret for database credentials (recommended for production)
    existingSecret: "norish2-db-credentials"          # Name of existing Kubernetes secret
    usernameKey: "username" 
    passwordKey: "password"
    databaseKey: "database"
  
  redis:
    # Redis connection details
    host: "dragonfly-cluster.dbs.svc.cluster.local"                    # Required: Redis server hostname
    port: 6379
    database: 4
    # Authentication (leave empty if Redis has no auth)
    username: "default"                # Optional: Redis username (Redis 6.0+)
    password: "{{ vault_dragonfly_password }}"                # Redis password (leave empty if no auth)

    # Use existing secret for Redis credentials (recommended for production)
    # NOTE: When using existingSecret, the secret MUST contain a key with the full Redis URL
    #       Format: redis://[username]:[password]@host:port/database
    existingSecret: ""          # Name of existing Kubernetes secret
    urlKey: "redis-url"         # Key in existingSecret containing the full Redis URL
    passwordKey: "password"     # Key in existingSecret for password (for compatibility)