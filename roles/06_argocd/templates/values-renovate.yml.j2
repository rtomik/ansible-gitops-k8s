---
renovate:
  # Disable built-in Redis and use external Dragonfly
  redis:
    enabled: false

  existingSecret: "gitea-api-token"

  # Configure Renovate to use external Dragonfly cache via environment variables
  env:
    RENOVATE_REDIS_URL: "redis://:{{ vault_dragonfly_password }}@{{ dragonfly.cluster_name | default('dragonfly-cluster') }}.{{ dragonfly.namespace | default('dbs') }}.svc.cluster.local:6379"
  
  cronjob:
    schedule: "0 2 * * *"  # Run daily at 2 AM
    timeZone: "{{ timezone }}"
  
  renovate:
    # Configuration for Renovate
    config: |
      {
        "$schema": "https://docs.renovatebot.com/renovate-schema.json",
        "extends": ["config:base"],
        "platform": "gitea",
        "endpoint": "https://git.{{ domain }}/api/v1/",
        "token": "{{ renovate_api_token }}",
        "repositories": ["{{ git_organization_name }}/{{ git_repo_name }}"],
        "onboarding": true,
        "onboardingConfig": {
          "extends": ["config:base"]
        },
        "gitAuthor": "Renovate Bot <renovate@{{ domain }}>"
      }

